# M5 里程碑目标（阶段 5）

依据 `docs/QRGen.md` 第 9、10 节（SVG 属于后续迭代扩展能力）的规划，M5 目标定义为：

## M5：支持输出 SVG 矢量图

### 目标
- 在保持现有 Terminal TUI 与位图输出能力不退化的前提下，新增 SVG 矢量导出。
- 让二维码在放大场景中保持清晰，满足打印、设计稿嵌入、网页矢量展示等需求。
- 统一纳入现有 `-o/--output` + `--format` 流程，避免新增独立命令分支。

### 范围（In Scope）
- 在 `--format` 中新增 `svg` 可选值。
- 当指定 `-o/--output` 且 `--format svg` 时，输出标准 `.svg` 文件。
- 未指定 `--format` 时保持当前默认行为（仍按现有默认格式输出，不因 SVG 引入变化）。
- SVG 输出使用矢量路径/矩形单元表达二维码模块，不依赖位图转码。
- 为 SVG 输出补充基本 XML 声明与 `viewBox`，确保浏览器与常见查看器可正确渲染。
- `--help` 与 README 补充 SVG 使用示例。

### 非范围（Out of Scope）
- SVG 样式高级定制（圆角模块、渐变、嵌入 Logo）。
- 自定义前景/背景颜色参数（如 `--fg`、`--bg`）。
- 将 SVG 转 PDF/EPS 等更多出版格式。
- 动画 SVG 或交互式 SVG。

### 具体达成要点
**功能实现（必需）**
- `--format svg` 参数解析与路由打通。
- 新增 SVG 编码实现，输出结果为合法 XML/SVG 文档。
- 文件扩展名与内容一致（`.svg` + SVG 文本内容）。

**兼容与稳定性（必需）**
- `qrgen "<CONTENT>"`（无 `-o`）仍走 Terminal TUI，不受影响。
- 现有 `png/jpeg/webp/avif` 导出行为不回退。
- 非法格式值继续返回非 `0`，错误提示保持清晰。

**测试与文档（必需）**
- 新增成功路径测试：`--format svg` 可成功生成文件。
- 新增结果校验：输出文件包含 `<svg`、`viewBox` 等关键标记。
- 回归测试：至少覆盖 1 条已有位图格式成功路径，避免引入回归。
- README 增加至少 2 条 SVG 示例（基础文本 + URL 场景）。

### 验收标准（M5 DoD）
1. `qrgen "hello svg" -o ./dist/hello.svg --format svg` 生成有效 SVG 文件。
2. 生成文件可被浏览器直接打开并正确显示二维码图案。
3. `qrgen "https://example.com" -o ./dist/site.svg --format svg` 执行成功，退出码为 `0`。
4. 不传 `--format` 的现有导出路径行为与当前版本一致（无回归）。
5. `--help` 与 README 明确列出 `svg` 支持及示例命令。
6. 自动化测试覆盖 SVG 成功路径与至少 1 条回归路径。

### 下一步目标（M6 候选）
- 在 SVG 与位图输出中统一支持颜色参数（前景/背景）。
- 增加纠错级别配置（L/M/Q/H）并补齐文档示例。
- 增加格式能力探测命令（如 `qrgen --list-formats`），显示当前构建可用格式。
